(this.webpackJsonpvirtual_office=this.webpackJsonpvirtual_office||[]).push([[40],{1198:function(e,t,a){"use strict";a.r(t);var s=a(6),l=a(10),n=a(32),o=a(493),i=(a(814),a(0)),r=(a(98),a(9)),c=(a(505),a(532),a(644)),d=(a(685),a(509)),u=(a(74),a(513),a(541)),f=(a(1199),a(3));t.default=function(){var e=Object(i.useState)([]),t=Object(n.a)(e,2),h=(t[0],t[1]),b=Object(i.useState)([]),j=Object(n.a)(b,2),m=j[0],y=j[1],x=Object(i.useState)([]),g=Object(n.a)(x,2),p=g[0],O=g[1],v=Object(i.useState)(0),w=Object(n.a)(v,2),D=w[0],k=w[1],C=Object(i.useState)(0),H=Object(n.a)(C,2),S=H[0],N=H[1];function z(){return(z=Object(l.a)(Object(s.a)().mark((function e(){var t,l,n,o,i,r,c,d;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a(793),l=new t.Workbook,(n=l.addWorksheet("sheet1")).mergeCells("B1:D2"),(o=n.getCell("C1")).value="Datasoft Manufacturing & Assembly",o.font={size:15,bold:!0},n.getCell("C1").alignment={horizontal:"center",vertical:"center"},n.mergeCells("B3:D3"),(i=n.getCell("C3")).value="Gulshan Branch",i.font={size:13,bold:!0},i.alignment={horizontal:"center",vertical:"center"},n.mergeCells("A5:B5"),n.getCell("A5").value="List of Holidays ("+S+")",n.getCell("A5").font={bold:!0},n.getCell("E5").value="Total Holidays "+D,n.getCell("E5").font={bold:!0},n.mergeCells("F6:G6"),n.mergeCells("A6:D6"),n.getRow(8).values=["Holiday Title","Start Date","End Date","Hours","Days"],n.getRow(8).font={name:"Arial Black",family:3,size:10},n.getRow(9).height=20,n.columns=[{key:"title",width:30},{key:"start",width:15},{key:"end",width:15},{key:"hours",width:15},{key:"days",width:15}],r=0;r<p.length;r++)n.addRow({title:p[r].holiday_title,start:p[r].start_date,end:p[r].end_date,hours:p[r].hours,days:p[r].hours/8});return e.next=27,l.xlsx.writeBuffer(p);case 27:c=e.sent,"application/octet-stream",".xlsx",d=new Blob([c],{type:"application/octet-stream"}),"List-of-Holidays.xlsx",Object(u.saveAs)(d,"List-of-Holidays.xlsx");case 33:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(i.useEffect)((function(){r.a.get("organizations/holiday/all/").then((function(e){console.log("res",e.data.data),h(e.data.data),function(e){for(var t=[],a=0;a<e.length;a++)t.push({"Holiday Title":e[a].holiday_title,"Start Date":e[a].start_date,"End Date":e[a].end_date,Hours:e[a].hours,Days:e[a].hours/8}),console.log("table data ",t);for(var s=0,l=0;l<e.length;l++)s+=t[l].Days;console.log("total days",s);var n=new Date;n=n.getFullYear(),N(n),k(s),y(t)}(e.data.data),O(e.data.data)}))}),[]),Object(f.jsxs)(o.l,{children:[Object(f.jsx)(o.K,{className:"justify-content-between",children:Object(f.jsxs)(o.k,{md:"12",children:[Object(f.jsxs)(o.K,{className:"justify-content-between",children:[Object(f.jsx)(o.k,{children:Object(f.jsxs)("h3",{className:"timecards-page-header mb-3",children:["List of Holidays (",S,")"]})}),Object(f.jsxs)(o.k,{md:"8",id:"tableRef",className:"d-flex justify-content-end",children:[Object(f.jsx)("h5",{className:"tiny-header--5 mt-3 mr-2",children:"Export "}),Object(f.jsxs)("div",{className:"format-buttons mt-3 mb-3 ",children:[Object(f.jsxs)(o.f,{className:"file-format-download",onClick:function(){return function(){var e=new c.default("portrait","pt","A4");e.setFontSize(15);var t=p.map((function(e,t){return[e.holiday_title,e.start_date,e.end_date,e.hours,e.hours/8]}));console.log("pdfData",t);var a={startY:140,head:[["Holiday Title","Start Date","End Date","Hours","Days"]],body:t};e.setFontSize(18),e.text(165,50,"Datasoft Manufacturing & Assembly"),e.setFontSize(14),e.text(230,65,"Gulshan Branch"),e.setFontSize(12),e.text(42,100,"List of Holidays ("+S+")"),e.text(450,100,"Total Holidays "+D),e.autoTable(a),e.save("List-of-Holidays.pdf")}()},children:[Object(f.jsx)(d.a,{name:"cil-description",className:"mr-2"})," PDF"]}),Object(f.jsxs)(o.f,{className:"file-format-download",onClick:function(){return function(){return z.apply(this,arguments)}()},children:[Object(f.jsx)(d.a,{name:"cil-spreadsheet",className:"mr-2"}),"Excel"]})]})]})]}),Object(f.jsx)(o.m,{items:m,fields:["Holiday Title","Start Date","End Date","Hours","Days"],primary:!0,hover:!0,striped:!0,bordered:!0,sorter:!0,size:"sm",itemsPerPage:20,pagination:!0})]})}),Object(f.jsx)(o.K,{className:"justify-content-end mb-5",children:Object(f.jsxs)(o.k,{md:"2",className:"justify-content-end tiny-header--5",children:["Total Holidays ",D]})})]})}},1199:function(e,t,a){},814:function(e,t,a){var s=a(173),l=a(26);e.exports=function(e,t,a,n){return null==e?[]:(l(t)||(t=null==t?[]:[t]),l(a=n?void 0:a)||(a=null==a?[]:[a]),s(e,t,a))}}}]);
//# sourceMappingURL=40.ea3fdabe.chunk.js.map