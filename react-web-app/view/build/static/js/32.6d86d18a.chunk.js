(this.webpackJsonpvirtual_office=this.webpackJsonpvirtual_office||[]).push([[32],{1453:function(e,t,n){"use strict";n.r(t);var a=n(6),l=n(2),s=n(10),r=n(32),c=n(493),o=n(546),i=n.n(o),d=n(509),u=n(0),m=n.n(u),f=n(98),b=(n(76),n(505)),O=n(74),h=n.n(O),j=(n(632),n(117)),g=n(644),p=(n(685),n(541)),x=n(9),y=n(515),C=n(127),k=n(3);t.default=function(){var e=Object(f.b)(),t=Object(u.useState)([]),o=Object(r.a)(t,2),O=o[0],v=o[1],S=Object(u.useState)(),M=Object(r.a)(S,2),w=M[0],_=M[1],H=Object(u.useState)(),T=Object(r.a)(H,2),Y=(T[0],T[1],Object(u.useState)()),B=Object(r.a)(Y,2),R=B[0],P=B[1],N=Object(u.useState)([]),W=Object(r.a)(N,2),D=W[0],A=W[1],F=[],E=Object(f.c)((function(e){return e.profile.data})),L=Object(f.c)((function(e){return e.worktypes.data})),I=Object(f.c)((function(e){var t=[];return Array.from(e.timecardList.user_weekly_submitted_timecards).forEach((function(e,n){t.push({id:e.employee.id,data:e.employee,Weekending:h()(e.week_end).format("ddd, MMMM DD, YYYY"),Name:e.employee.first_name+" "+e.employee.last_name,Total:e.total_hours,RHR:null==e.RHR?"-":e.RHR,SIC:null==e.SIC?"-":e.SIC,HOL:null==e.HOL?"-":e.HOL,WFH:null==e.WFH?"-":e.WFH,OTO:null==e.OTO?"-":e.OTO,VAC:null==e.VAC?"-":e.VAC,COM:null==e.COM?"-":e.COM,PB:null==e.PB?"-":e.PB,PB1:null==e.PB1?"-":e.PB1,PB2:null==e.PB2?"-":e.PB2,Submitted:h()(e.submitted_at).format("ddd, MMMM DD, YYYY")+" at "+h()(e.submitted_at).format("h:mm")})})),F=[].concat(t),t})),V=Object(u.useState)([]),z=Object(r.a)(V,2),K=z[0],G=z[1],J=Object(f.c)((function(e){var t=[];Array.from(e.timecardList.user_weekly_submitted_timecards).forEach((function(e,n){t.push({data:e,label:h()(e.week_end).format("ddd, MMMM DD, YYYY"),value:h()(e.week_end).format("ddd, MMMM DD, YYYY")})}));var n=i()(t,"label");return n.sort((function(e,t){var n=h()(e.data.week_end);return h()(t.data.week_end)-n})),n})),q=function(){return"undefined"==w||null==w?(i()(I,"Name"),I):(i()(K,"Name"),K)};m.a.useEffect((function(){e(Object(j.e)()),x.a.get("auth/assignee/list/").then((function(e){console.log("assignees",e.data.data);var t=[];Array.from(e.data.data).forEach((function(e,n){""!=e.first_name&&t.push({value:e.id,label:e.first_name+" "+e.last_name,data:e})})),console.log("all assignees",t.length),v(t.length)})),0===L.length&&e(Object(C.b)())}),[]),m.a.useEffect((function(){L.length>0&&function(){var e=[];e.push({key:"Weekending",_style:{width:"15%"},_classes:"font-weight-bold"}),e.push("Name"),e.push("Total"),L.map((function(t,n){e.push({key:t.title,sorter:!1})})),console.log("SETTING HEADERS"),e.push("Submitted"),P(e)}()}),[L]);function Q(){return(Q=Object(s.a)(Object(a.a)().mark((function e(){var t,s,r,c,o,i,d,u,m,f,b,O,j,g,x,y,C;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n(793),s=new t.Workbook,(r=s.addWorksheet("sheet1")).mergeCells("B1:F2"),(c=r.getCell("C1")).value="Datasoft Manufacturing & Assembly",c.font={size:15,bold:!0},r.getCell("C1").alignment={horizontal:"center",vertical:"center"},r.mergeCells("C3:D3"),(o=r.getCell("C3")).value="Gulshan Branch",o.font={size:13,bold:!0},o.alignment={horizontal:"center",vertical:"center"},r.mergeCells("A5:B5"),r.getCell("A5").value="Submitted Timecards",r.getRow(8).values=["Weekending","Name","Total","RHR","SIC","HOL","PB1","PB2","WFH","OTO","VAC","+COM","-COM","Submitted"],r.getRow(8).font={name:"Arial Black",family:3,size:9},r.getRow(8).height=20,r.columns=[{key:"Weekending",width:20},{key:"Name",width:25},{key:"Total",width:10},{key:"RHR",width:10},{key:"SIC",width:10},{key:"HOL",width:10},{key:"PB1",width:10},{key:"PB2",width:10},{key:"WFH",width:10},{key:"OTO",width:10},{key:"VAC",width:10},{key:"+COM",width:10},{key:"-COM",width:10},{key:"Submitted",width:20}],console.log("submitted",F),"undefined"==w||null==w){for(i=0;i<I.length;i++)r.addRow((d={Weekending:I[i].Weekending,Name:I[i].Name,Total:I[i].Total,RHR:I[i].RHR,SIC:I[i].SIC,HOL:I[i].HOL,PB1:I[i].PB1},Object(l.a)(d,"PB1",I[i].PB2),Object(l.a)(d,"WFH",I[i].WFH),Object(l.a)(d,"OTO",I[i].OTO),Object(l.a)(d,"VAC",I[i].VAC),Object(l.a)(d,"pCOM",I[i].pCOM),Object(l.a)(d,"nCOM",I[i].nCOM),Object(l.a)(d,"Submitted",I[i].Submitted),d));u=I.length+11,0!=I.length&&(r.getRow(u).values=["Total Submitted =  "+I.length])}else{for(m=0;m<D.length;m++)r.addRow({Weekending:D[m].Weekending,Name:D[m].Name,Total:D[m].Total,RHR:D[m].RHR,SIC:D[m].SIC,HOL:D[m].HOL,PB1:D[m].PB1,PB2:D[m].PB2,WFH:D[m].WFH,OTO:D[m].OTO,VAC:D[m].VAC,pCOM:D[m].pCOM,nCOM:D[m].nCOM,Submitted:D[m].Submitted});f=D.length+11,0!=D.length&&(r.getRow(f).values=["Total Submitted =  "+D.length])}return e.next=23,s.xlsx.writeBuffer();case 23:b=e.sent,"application/octet-stream",".xlsx",O=new Blob([b],{type:"application/octet-stream"}),j=E.first_name+"_"+E.last_name,g=new Date,x=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][g.getDay()],y=h()(g).format("DD-MM-YYYY"),C=j+"_"+x+"_"+y+"_.xlsx",Object(p.saveAs)(O,C);case 34:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var U=Object(u.useState)(""),X=Object(r.a)(U,2),Z=(X[0],X[1],Object(u.useState)("")),$=Object(r.a)(Z,2),ee=($[0],$[1],Object(u.useState)(0)),te=Object(r.a)(ee,2);te[0],te[1];return Object(k.jsx)(k.Fragment,{children:Object(k.jsxs)(c.l,{children:[Object(k.jsxs)(c.K,{children:[Object(k.jsx)(c.k,{children:Object(k.jsx)("h3",{className:"timecards-page-header mb-3",children:"Submitted Timecards"})}),Object(k.jsxs)(c.k,{md:"8",id:"tableRef",className:"d-flex justify-content-end",children:[Object(k.jsx)("h5",{className:"tiny-header--5 mt-3 mr-2",children:"Export "}),Object(k.jsxs)("div",{className:"format-buttons mt-3 mb-3 ",children:[Object(k.jsxs)(c.f,{className:"file-format-download",onClick:function(){!function(){var e=E.first_name+"_"+E.last_name,t=new g.default("portrait","pt","A4");t.setFontSize(15);var n=[];"undefined"==w||null==w?(A(I),console.log("submitted tcs",I),n=I.map((function(e,t){return[e.Weekending,e.Name,e.Total,e.RHR,e.SIC,e.HOL,e.PB1,e.PB2,e.WFH,e.OTO,e.VAC,e.pCOM,e.nCOM,e.Submitted,console.log("data",e)]}))):n=D.map((function(e,t){return[e.Weekending,e.Name,e.Total,e.RHR,e.SIC,e.HOL,e.PB1,e.PB2,e.WFH,e.OTO,e.VAC,e.pCOM,e.nCOM,e.Submitted,console.log("data",e)]}));var a={startY:145,head:R,body:n},l=new Date,s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][l.getDay()],r=h()(l).format("DD-MM-YYYY");console.log("days ",r),t.text(170,50,"Datasoft Manufacturing & Assembly"),t.setFontSize(13),t.text(245,75,"Gulshan Branch"),t.setFontSize(11),t.text(42,105,"Submitted Time Cards"),Object(b.g)("projects.add_projects")||t.text(42,125,"Employee Name: "+e),t.text(440,360,"Total "+F.length+" Submitted"),t.autoTable(a),t.save(e+"_"+s+"_"+r+"_.pdf")}()},children:[Object(k.jsx)(d.a,{name:"cil-description",className:"mr-2"})," PDF"]}),Object(k.jsxs)(c.f,{className:"file-format-download",onClick:function(){!function(){Q.apply(this,arguments)}()},children:[Object(k.jsx)(d.a,{name:"cil-spreadsheet",className:"mr-2"}),"Excel"]})]})]})]}),Object(k.jsx)(c.K,{children:Object(k.jsx)(c.k,{xl:"3",lg:"3",md:"6",children:Object(k.jsxs)("div",{children:[Object(k.jsx)(c.z,{className:"custom-label-5",htmlFor:"assigneeSelectPM",children:"Select Weekending"}),Object(k.jsx)(y.a,{closeMenuOnSelect:!0,placeholder:"",id:"assigneeSelectPM",minHeight:"35px",isClearable:!0,isMulti:!1,onChange:function(e,t){_(e);var n=[];if("select-option"==t.action){n=[],console.log("select");for(var a=0;a<I.length;a++)e.value==I[a].Weekending&&n.push(I[a])}else if("clear"==t.action){console.log("clear");for(var l=0;l<I.length;l++)n.push(I[l])}console.log("filtered",n),G(n),A(n)},classNamePrefix:"custom-forminput-6",options:J,value:w})]})})}),Object(k.jsx)(c.K,{children:!Object(b.g)("projects.add_projects")&&Object(k.jsx)(c.k,{})}),Object(k.jsx)(c.K,{className:"mt-5",children:Object(k.jsxs)(c.k,{children:[console.log("HEADERS",R),void 0===R?null:Object(k.jsx)(c.m,{items:q(),fields:R,itemsPerPage:10,pagination:!0,striped:!0,bordered:!0,sorter:!0,scopedSlots:{Name:function(e){return Object(k.jsx)("td",{children:Object(k.jsx)("a",{onClick:function(){!function(e){var t=h()(e.Weekending).format("YYYY-MM-DD"),n=h()(e.Weekending).subtract(6,"day").toDate();n=h()(n).format("YYYY-MM-DD");var a=e.id,l=e.Name;x.a.get("wbs/user/time-card/list/"+a+"/").then((function(e){var a,s=[];Array.from(e.data.data).forEach((function(e,t){s.push({data:e})})),console.log("temp",s),a=s.filter((function(e){return e.data.date_updated>=n&&e.data.date_updated<=t})),console.log("filtered",a);for(var r=0,c=[],o=0;o<a.length;o++)a[o].data.submitted,1==a[o].data.submitted&&(c.push(a[o]),r+=parseFloat(a[o].data.hours_today));console.log("submittedtcs",c),console.log("total hours",r),Object(b.e)(c,l,t,r,n)}))}(e)},size:"sm",type:"button",color:"primary",children:Object(k.jsxs)("u",{children:[" ",e.Name]})})})}}}),Object(k.jsx)("div",{class:"alert alert-info",role:"alert",children:Object(k.jsxs)(c.K,{children:[Object(k.jsx)(c.k,{md:"9"}),Object(b.g)("projects.add_projects")&&Object(k.jsx)(c.k,{md:"3",children:Object(k.jsxs)("small",{children:["   ","Total"," ",Object(k.jsxs)("b",{children:["\xa0",i()(q(),"Name").length," / ",O," \xa0"]}),"Employees Submitted"]})}),!Object(b.g)("projects.add_projects")&&Object(k.jsx)(c.k,{md:"3",children:Object(k.jsxs)("small",{children:["   ","Total"," ",Object(k.jsxs)("b",{children:["\xa0",q().length," "," \xa0"]}),"Submitted"]})})]})})]})})]})})}},538:function(e,t,n){var a=n(167),l=n(547),s=n(552),r=n(168),c=n(553),o=n(163);e.exports=function(e,t,n){var i=-1,d=l,u=e.length,m=!0,f=[],b=f;if(n)m=!1,d=s;else if(u>=200){var O=t?null:c(e);if(O)return o(O);m=!1,d=r,b=new a}else b=t?[]:f;e:for(;++i<u;){var h=e[i],j=t?t(h):h;if(h=n||0!==h?h:0,m&&j===j){for(var g=b.length;g--;)if(b[g]===j)continue e;t&&b.push(j),f.push(h)}else d(b,j,n)||(b!==f&&b.push(j),f.push(h))}return f}},546:function(e,t,n){var a=n(166),l=n(538);e.exports=function(e,t){return e&&e.length?l(e,a(t,2)):[]}},547:function(e,t,n){var a=n(548);e.exports=function(e,t){return!!(null==e?0:e.length)&&a(e,t,0)>-1}},548:function(e,t,n){var a=n(549),l=n(550),s=n(551);e.exports=function(e,t,n){return t===t?s(e,t,n):a(e,l,n)}},549:function(e,t){e.exports=function(e,t,n,a){for(var l=e.length,s=n+(a?1:-1);a?s--:++s<l;)if(t(e[s],s,e))return s;return-1}},550:function(e,t){e.exports=function(e){return e!==e}},551:function(e,t){e.exports=function(e,t,n){for(var a=n-1,l=e.length;++a<l;)if(e[a]===t)return a;return-1}},552:function(e,t){e.exports=function(e,t,n){for(var a=-1,l=null==e?0:e.length;++a<l;)if(n(t,e[a]))return!0;return!1}},553:function(e,t,n){var a=n(169),l=n(554),s=n(163),r=a&&1/s(new a([,-0]))[1]==1/0?function(e){return new a(e)}:l;e.exports=r},554:function(e,t){e.exports=function(){}},632:function(e,t,n){}}]);
//# sourceMappingURL=32.6d86d18a.chunk.js.map