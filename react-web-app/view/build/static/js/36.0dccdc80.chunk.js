(this.webpackJsonpvirtual_office=this.webpackJsonpvirtual_office||[]).push([[36],{1125:function(e,t,a){"use strict";a.r(t);var r=a(104),s=a(17),n=a(32),o=a(493),c=a(0),l=a.n(c),i=(a(1126),a(98)),d=a(100),u=a(515),b=a(9),j=a(532),m=a(513),f=a.n(m),v=a(567),g=a(76),O=a.n(g),h=a(505),p=a(14),x=(a(128),a(103)),_=a(74),k=a.n(_),w=a(708),y=a(3);t.default=function(){var e=Object(i.b)(),t=Object(c.useState)([]),a=Object(n.a)(t,2),m=a[0],g=a[1],_=Object(c.useState)([]),S=Object(n.a)(_,2),N=S[0],C=S[1],I=Object(i.c)((function(e){var t=[];return Array.from(e.projects.data).forEach((function(e,a){parseFloat(e.project.remaining_hours)>0&&t.push({value:e.project.id,label:e.project.sub_task,data:e})})),Object(h.g)("projects.add_projects")&&Array.from(e.projects.pm_projects).forEach((function(e,a){parseFloat(e.project.remaining_hours)>0&&(t.find((function(t){return t.label===e.project.sub_task}))||t.push({value:e.project.id,label:e.project.sub_task,data:e}))})),t})),P=function(e){if(console.log("task list###########: ",e),Object(h.g)("projects.add_projects"))C(O()(e,"task_title"));else{var t=[];e.forEach((function(e){e.assignees.forEach((function(a){console.log(a.assignee.id),a.assignee.id==sessionStorage.getItem(b.k)&&t.push(e)}))})),C(O()(t,"task_title"))}},z=Object(c.useRef)(),F=Object(c.useRef)(),B=Object(c.useRef)(),q=Object(c.useState)(null),D=Object(n.a)(q,2),V=D[0],R=D[1],E=Object(c.useState)({}),L=Object(n.a)(E,2),M=L[0],A=L[1],T=Object(c.useState)(""),W=Object(n.a)(T,2),J=W[0],U=W[1],H=Object(c.useState)(""),K=Object(n.a)(H,2),X=K[0],Y=K[1],G=Object(c.useState)([]),Q=Object(n.a)(G,2),Z=Q[0],$=Q[1],ee=function(t){e(Object(d.c)(null===t||void 0===t?void 0:t.work_package_index));var a=[],r=[];return t.assignees.forEach((function(e){r.push(e.assignee.id),a.push({value:e.assignee.id,label:e.assignee.first_name+" "+e.assignee.last_name,data:e.assignee})})),(a=O()(a,"label")).unshift({value:"All",label:"Select All"}),g(a),{assignees:a,assignee_ids:r}},te=Object(x.b)(),ae=te.enqueueSnackbar,re=(te.closeSnackbar,Object(c.useState)([])),se=Object(n.a)(re,2),ne=se[0],oe=se[1],ce=function(){le.resetForm(),z.current.select.clearValue(),F.current.select.clearValue(),B.current.select.clearValue(),U(),Y(),R(null),g([])},le=Object(j.a)({initialValues:{project:"",work_package_number:"",assignee:[],reporter:sessionStorage.getItem(b.k),title:"",description:"",start_date:"",end_date:"",hours_worked:"0",status:"1",progress:"0",comments:"",deliverable:""},validateOnChange:!0,validateOnBlur:!0,validate:function(e){var t,a,r={};return e.project||(r.project="Project is required"),e.title||(r.title="Title is required"),e.start_date||(r.start_date="Start date is required"),e.end_date||(r.end_date="End date is required"),e.start_date&&(t=e.start_date,a=e.end_date,new Date(a)<new Date(t))&&(r.end_date="End date can not be past from start date"),e.assignee.length<1&&(r.assignee="Assignee is required"),r},onSubmit:function(t,a){var s=a.setSubmitting,n=new Date,o="".concat(n.getFullYear(),"-").concat(n.getMonth()+1,"-").concat(n.getDate()).split("-"),c=(J.split("-"),k()([parseInt(o[0]),parseInt(o[1])-1,parseInt(o[2])])),l=k()(J);if(c.diff(l,"days")<=0){console.log("values",JSON.stringify(le.values));var i=new FormData;for(var u in console.log("total",ne.length),i.append("total_files",ne.length),le.values)i.append(u,le.values[u]);for(var j=1;j<=ne.length;j++)i.append("file"+j,ne[j-1]);var m,v=Object(r.a)(i.entries());try{for(v.s();!(m=v.n()).done;){var g=m.value;console.log(g[0]+", "+g[1])}}catch(O){v.e(O)}finally{v.f()}b.a.post("wbs/create/",i).then((function(t){console.log(t),200===t.status&&"True"===t.data.success&&(ce(),C([]),oe([]),e(Object(d.g)(sessionStorage.getItem(b.k))),e(Object(d.e)(sessionStorage.getItem(b.k))),e(Object(d.d)(sessionStorage.getItem(b.k))),f()("WBS Created Successfully !","","success")),ce(),R(null)})).catch((function(e){console.log(e),s(!1)}))}else ae("Planned Delivery date is over! ",{variant:"warning"}),s(!1)}});var ie=Object(p.h)();return l.a.useEffect((function(){var e;if(console.log("location ",ie),null!==(e=ie.state)&&void 0!==e&&e.task){var t=ie.state.task;console.log("location data if block",t),function(e){var t=I;console.log("projects",I),t.forEach((function(t,a){t.label==e&&(A(t),P(t.data.subtasks))}))}(t.sub_task),R(t);var a=ee(t);console.log("shifted result",a.assignees.slice(1)),$(a.assignees.slice(1)),U(t.planned_delivery_date),Y(t.start_date),le.setValues({project:t.id,work_package_number:t.work_package_number,assignee:a.assignee_ids,reporter:sessionStorage.getItem(b.k),title:le.values.title,description:le.values.description,start_date:le.values.start_date,end_date:le.values.end_date,hours_worked:le.values.hours_worked,status:le.values.status,progress:le.values.progress,comments:le.values.comments,deliverable:le.values.deliverable})}}),[]),Object(y.jsx)(y.Fragment,{children:Object(y.jsx)(o.l,{children:Object(y.jsx)(o.K,{children:Object(y.jsx)("div",{className:"col-md-8 offset-md-2 col-sm-12",children:Object(y.jsxs)(o.g,{className:"custom-wbs-card-1",children:[Object(y.jsxs)(o.j,{className:"project-wbs-1",children:[" ",Object(y.jsx)("h4",{className:"section-name-wbscreate",children:"Create a WBS"})]}),Object(y.jsx)(o.h,{children:Object(y.jsx)(o.l,{children:Object(y.jsx)(o.t,{children:Object(y.jsxs)(o.K,{children:[Object(y.jsxs)("div",{className:"col-lg-12 mb-3",children:[Object(y.jsx)(o.z,{className:"custom-label-wbs5",children:"Select Project"}),Object(y.jsx)(u.a,{id:"project",options:I,value:M,onChange:function(e,t){console.log("action: ".concat(t.action)),console.log("newValue: ",e),"select-option"==t.action?(A(e),P(e.data.subtasks),le.setValues({project:e.data.project.id,work_package_number:e.data.project.work_package_number,assignee:le.values.assignee,reporter:sessionStorage.getItem(b.k),title:le.values.title,description:le.values.description,start_date:le.values.start_date,end_date:le.values.end_date,hours_worked:le.values.hours_worked,status:le.values.status,progress:le.values.progress,comments:le.values.comments,deliverable:le.values.deliverable})):"clear"==t.action&&A(null)},ref:z}),le.touched.project&&le.errors.project&&Object(y.jsx)("small",{style:{color:"red"},children:le.errors.project})]}),Object(y.jsxs)("div",{className:"col-lg-12 mb-3",children:[Object(y.jsx)(o.z,{className:"custom-label-wbs5",children:"Task Title"}),Object(y.jsx)(u.a,{id:"task_title",options:N,getOptionLabel:function(e){return e.task_title},getOptionValue:function(e){return e.id},onChange:function(e,t){null!=e&&(ee(e),console.log("task",e.start_date),R(e),U(null===e||void 0===e?void 0:e.planned_delivery_date),Y(null===e||void 0===e?void 0:e.start_date)),"select-option"==t.action&&le.setValues({project:e.id,work_package_number:le.values.work_package_number,assignee:le.values.assignee,reporter:sessionStorage.getItem(b.k),title:le.values.title,description:le.values.description,start_date:le.values.start_date,end_date:le.values.end_date,hours_worked:le.values.hours_worked,status:le.values.status,progress:le.values.progress,comments:le.values.comments,deliverable:le.values.deliverable})},value:V,ref:B}),le.touched.task_title&&le.errors.task_title&&Object(y.jsx)("small",{style:{color:"red"},children:le.errors.task_title})]}),null!=V?Object(y.jsx)("div",{className:"col-lg-12 mb-3",children:Object(y.jsx)(o.a,{color:"primary",children:Object(y.jsxs)("small",{children:[Object(y.jsx)("b",{children:"Work Package Number: "})," ",V.work_package_number,Object(y.jsx)("br",{}),Object(y.jsx)("b",{children:"Planned Delivery Date: "})," ",V.planned_delivery_date,Object(y.jsx)("br",{}),Object(y.jsx)("b",{children:"Planned Hours: "})," ",Number(parseFloat(V.planned_hours)).toFixed(2),Object(y.jsx)("br",{}),Object(y.jsx)("b",{children:"Remaining Hours: "})," ",Number(parseFloat(V.remaining_hours)).toFixed(2),Object(y.jsx)("br",{}),Object(y.jsx)("b",{children:"Task details: "})," ",V.description]})})}):Object(y.jsx)(y.Fragment,{}),Object(y.jsxs)("div",{className:"col-lg-12 mb-3",children:[Object(y.jsx)(o.z,{className:"custom-label-wbs5",children:"WBS Title"}),Object(y.jsx)(o.y,{id:"title",name:"title",maxlength:"50",value:le.values.title,onChange:le.handleChange,className:"custom-forminput-6"}),Object(y.jsxs)("div",{className:"float-right",children:[le.values.title.length,"/50"]}),le.touched.title&&le.errors.title&&Object(y.jsx)("small",{style:{color:"red"},children:le.errors.title})]}),Object(y.jsxs)("div",{className:"col-lg-12 mb-3",children:[Object(y.jsx)(o.z,{className:"custom-label-wbs5",children:"Description"}),Object(y.jsx)(o.V,{maxlength:"120",id:"description",name:"description",value:le.values.description,onChange:le.handleChange,className:"custom-forminput-6"}),Object(y.jsxs)("div",{className:"float-right",children:[le.values.description.length,"/120"]})]}),Object(y.jsxs)("div",{className:"col-lg-6 mb-3",children:[Object(y.jsx)(o.z,{className:"custom-label-wbs5",children:"Start date"}),Object(y.jsx)(o.y,{max:J,min:X,type:"date",id:"start_date",name:"start_date",value:le.values.start_date,onChange:le.handleChange,className:"custom-forminput-6"}),le.touched.start_date&&le.errors.start_date&&Object(y.jsx)("small",{style:{color:"red"},children:le.errors.start_date})]}),Object(y.jsxs)("div",{className:"col-lg-6 mb-3",children:[Object(y.jsx)(o.z,{className:"custom-label-wbs5",children:"End date"}),Object(y.jsx)(o.y,{max:J,min:le.values.start_date,type:"date",id:"end_date",name:"end_date",value:le.values.end_date,onChange:le.handleChange,className:"custom-forminput-6"}),le.touched.end_date&&le.errors.end_date&&Object(y.jsx)("small",{style:{color:"red"},children:le.errors.end_date})]}),Object(y.jsxs)("div",{className:"col-lg-12 mb-3",children:[Object(y.jsx)(o.z,{className:"custom-label-wbs5",children:"Assignee(s)"}),Object(y.jsx)(u.a,{className:"custom-forminput-6",ref:F,options:m,isMulti:!0,onChange:function(e,t){var a=[],r=[];if("select-option"==t.action)console.log("action",t),$(e),console.log("rats",Z),e.forEach((function(e){if("All"==e.value){(r=Object(s.a)(m)).shift(),$(r),console.log("arr",r),console.log("len",r.length);for(var t=0;t<r.length;t++)a[t]=r[t].value;console.log("assinearray",a)}else a.push(e.value)}));else if("remove-value"==t.action){console.log("removed",t.removedValue),r=Object(s.a)(Z),console.log("arr",r);for(var n=0;n<r.length;n++)t.removedValue==r[n]&&r.splice(n,1);$(r);for(var o=0;o<r.length;o++)a[o]=r[o].value}console.log("action ",t),"clear"==t.action&&$(null),console.log("after removed ",a),le.setFieldValue("assignee",a)},value:Z}),le.touched.assignee&&le.errors.assignee&&Object(y.jsx)("small",{style:{color:"red"},children:le.errors.assignee})]}),Object(y.jsx)("div",{className:"col-lg-12",children:Object(y.jsx)(w.a,{files:ne,setFiles:function(e){console.log("parent files",e),oe(e)}})}),Object(y.jsx)(o.k,{children:Object(y.jsx)("div",{className:"col-md-12",children:1==!(!le.isSubmitting||le.isValidating)?Object(y.jsx)(v.a,{}):Object(y.jsxs)("div",{className:"projectwbs-form-button-holders mt-3",children:[Object(y.jsx)(o.f,{type:"button",onClick:le.handleSubmit,className:"create-btn-prjctwbs create-wbs",children:"Create WBS"}),Object(y.jsx)(o.f,{type:"button",onClick:ce,className:"create-btn-prjctwbs cancel-wbs",children:"Cancel"})]})})})]})})})})]})})})})})}},1126:function(e,t,a){},567:function(e,t,a){"use strict";var r=a(12),s=a(1),n=a(519),o=a(0),c=a(25),l=a(481),i=a(51),d=a(480),u=a(41),b=a(53),j=a(36),m=a(50),f=a(482),v=a(308);function g(e){return Object(v.a)("MuiLinearProgress",e)}Object(f.a)("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);var O,h,p,x,_,k,w,y,S,N,C,I,P=a(3),z=["className","color","value","valueBuffer","variant"],F=Object(i.e)(w||(w=O||(O=Object(n.a)(["\n  0% {\n    left: -35%;\n    right: 100%;\n  }\n\n  60% {\n    left: 100%;\n    right: -90%;\n  }\n\n  100% {\n    left: 100%;\n    right: -90%;\n  }\n"])))),B=Object(i.e)(y||(y=h||(h=Object(n.a)(["\n  0% {\n    left: -200%;\n    right: 100%;\n  }\n\n  60% {\n    left: 107%;\n    right: -8%;\n  }\n\n  100% {\n    left: 107%;\n    right: -8%;\n  }\n"])))),q=Object(i.e)(S||(S=p||(p=Object(n.a)(["\n  0% {\n    opacity: 1;\n    background-position: 0 -23px;\n  }\n\n  60% {\n    opacity: 0;\n    background-position: 0 -23px;\n  }\n\n  100% {\n    opacity: 1;\n    background-position: -200px -23px;\n  }\n"])))),D=function(e,t){return"inherit"===t?"currentColor":e.vars?e.vars.palette.LinearProgress["".concat(t,"Bg")]:"light"===e.palette.mode?Object(d.e)(e.palette[t].main,.62):Object(d.b)(e.palette[t].main,.5)},V=Object(j.a)("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:function(e,t){var a=e.ownerState;return[t.root,t["color".concat(Object(u.a)(a.color))],t[a.variant]]}})((function(e){var t=e.ownerState,a=e.theme;return Object(s.a)(Object(s.a)(Object(s.a)({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},backgroundColor:D(a,t.color)},"inherit"===t.color&&"buffer"!==t.variant&&{backgroundColor:"none","&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}}),"buffer"===t.variant&&{backgroundColor:"transparent"}),"query"===t.variant&&{transform:"rotate(180deg)"})})),R=Object(j.a)("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:function(e,t){var a=e.ownerState;return[t.dashed,t["dashedColor".concat(Object(u.a)(a.color))]]}})((function(e){var t=e.ownerState,a=e.theme,r=D(a,t.color);return Object(s.a)(Object(s.a)({position:"absolute",marginTop:0,height:"100%",width:"100%"},"inherit"===t.color&&{opacity:.3}),{},{backgroundImage:"radial-gradient(".concat(r," 0%, ").concat(r," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0 -23px"})}),Object(i.c)(N||(N=x||(x=Object(n.a)(["\n    animation: "," 3s infinite linear;\n  "]))),q)),E=Object(j.a)("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:function(e,t){var a=e.ownerState;return[t.bar,t["barColor".concat(Object(u.a)(a.color))],("indeterminate"===a.variant||"query"===a.variant)&&t.bar1Indeterminate,"determinate"===a.variant&&t.bar1Determinate,"buffer"===a.variant&&t.bar1Buffer]}})((function(e){var t=e.ownerState,a=e.theme;return Object(s.a)(Object(s.a)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",backgroundColor:"inherit"===t.color?"currentColor":(a.vars||a).palette[t.color].main},"determinate"===t.variant&&{transition:"transform .".concat(4,"s linear")}),"buffer"===t.variant&&{zIndex:1,transition:"transform .".concat(4,"s linear")})}),(function(e){var t=e.ownerState;return("indeterminate"===t.variant||"query"===t.variant)&&Object(i.c)(C||(C=_||(_=Object(n.a)(["\n      width: auto;\n      animation: "," 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;\n    "]))),F)})),L=Object(j.a)("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:function(e,t){var a=e.ownerState;return[t.bar,t["barColor".concat(Object(u.a)(a.color))],("indeterminate"===a.variant||"query"===a.variant)&&t.bar2Indeterminate,"buffer"===a.variant&&t.bar2Buffer]}})((function(e){var t=e.ownerState,a=e.theme;return Object(s.a)(Object(s.a)(Object(s.a)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},"buffer"!==t.variant&&{backgroundColor:"inherit"===t.color?"currentColor":(a.vars||a).palette[t.color].main}),"inherit"===t.color&&{opacity:.3}),"buffer"===t.variant&&{backgroundColor:D(a,t.color),transition:"transform .".concat(4,"s linear")})}),(function(e){var t=e.ownerState;return("indeterminate"===t.variant||"query"===t.variant)&&Object(i.c)(I||(I=k||(k=Object(n.a)(["\n      width: auto;\n      animation: "," 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;\n    "]))),B)})),M=o.forwardRef((function(e,t){var a=Object(m.a)({props:e,name:"MuiLinearProgress"}),n=a.className,o=a.color,i=void 0===o?"primary":o,d=a.value,j=a.valueBuffer,f=a.variant,v=void 0===f?"indeterminate":f,O=Object(r.a)(a,z),h=Object(s.a)(Object(s.a)({},a),{},{color:i,variant:v}),p=function(e){var t=e.classes,a=e.variant,r=e.color,s={root:["root","color".concat(Object(u.a)(r)),a],dashed:["dashed","dashedColor".concat(Object(u.a)(r))],bar1:["bar","barColor".concat(Object(u.a)(r)),("indeterminate"===a||"query"===a)&&"bar1Indeterminate","determinate"===a&&"bar1Determinate","buffer"===a&&"bar1Buffer"],bar2:["bar","buffer"!==a&&"barColor".concat(Object(u.a)(r)),"buffer"===a&&"color".concat(Object(u.a)(r)),("indeterminate"===a||"query"===a)&&"bar2Indeterminate","buffer"===a&&"bar2Buffer"]};return Object(l.a)(s,g,t)}(h),x=Object(b.a)(),_={},k={bar1:{},bar2:{}};if("determinate"===v||"buffer"===v)if(void 0!==d){_["aria-valuenow"]=Math.round(d),_["aria-valuemin"]=0,_["aria-valuemax"]=100;var w=d-100;"rtl"===x.direction&&(w=-w),k.bar1.transform="translateX(".concat(w,"%)")}else 0;if("buffer"===v)if(void 0!==j){var y=(j||0)-100;"rtl"===x.direction&&(y=-y),k.bar2.transform="translateX(".concat(y,"%)")}else 0;return Object(P.jsxs)(V,Object(s.a)(Object(s.a)(Object(s.a)({className:Object(c.default)(p.root,n),ownerState:h,role:"progressbar"},_),{},{ref:t},O),{},{children:["buffer"===v?Object(P.jsx)(R,{className:p.dashed,ownerState:h}):null,Object(P.jsx)(E,{className:p.bar1,ownerState:h,style:k.bar1}),"determinate"===v?null:Object(P.jsx)(L,{className:p.bar2,ownerState:h,style:k.bar2})]}))}));t.a=M},708:function(e,t,a){"use strict";var r=a(17),s=a(32),n=a(0),o=a(493),c=(a(709),a(9),a(505)),l=(a(513),a(3));t.a=function(e){var t=Object(n.useRef)(),a=Object(n.useState)(),i=Object(s.a)(a,2),d=(i[0],i[1],Object(n.useState)(),Object(n.useState)(e.files)),u=Object(s.a)(d,2),b=u[0],j=u[1],m=Object(n.useState)([]),f=Object(s.a)(m,2),v=f[0],g=f[1];return Object(l.jsx)(l.Fragment,{children:Object(l.jsx)(o.g,{className:"mt-2 upload-docs",children:Object(l.jsx)(o.h,{children:Object(l.jsxs)(o.l,{children:[Object(l.jsxs)(o.k,{className:"mb-1",children:[Object(l.jsx)(o.z,{htmlFor:"attachments",className:"custom-label-5",children:"Upload Documents"}),Object(l.jsxs)(o.z,{className:"custom-file-upload",children:[Object(l.jsx)(o.y,{type:"file",id:"file",ref:t,className:"form-control form-control-file",onChange:function(t){return function(t){var a=t.target.files[0];t.target.value=null,j([].concat(Object(r.a)(b),[a])),g([].concat(Object(r.a)(v),[URL.createObjectURL(a)])),e.setFiles([].concat(Object(r.a)(b),[a]))}(t)},accept:".xlsx, .xls, .csv, .pdf, image/*, application/gzip, .zip, .tar, .txt, .doc, .docx, .pptx, .ppt"}),Object(l.jsx)("img",{src:"assets/icons/upload-thin.svg",alt:"",className:"upload-icon"})]})]}),Object(l.jsx)(o.k,{}),Object(l.jsx)("div",{className:"mb-2",children:Object(l.jsx)("div",{className:"row",children:v.map((function(t,a){return Object(l.jsx)("div",{className:"col-md-6 col-sm-6 col-sm-4",children:Object(l.jsxs)("div",{className:"file-attached-ongoing rounded-pill",children:[Object(l.jsx)(o.f,{className:"remove-file-ongoing",type:"button",onClick:function(){var t;t=a,console.log("on remove",Object(c.a)(b,b[t])),g(Object(c.a)(v,v[t])),j(Object(c.a)(b,b[t])),e.setFiles(Object(c.a)(b,b[t]))},children:Object(l.jsx)("img",{src:"assets/icons/icons8-close-64-blue.svg",className:"close-icon-size"})}),b[a].name]})},a)}))})})]})})})})}},709:function(e,t,a){}}]);
//# sourceMappingURL=36.0dccdc80.chunk.js.map