(this.webpackJsonpvirtual_office=this.webpackJsonpvirtual_office||[]).push([[29],{1129:function(e,t,a){"use strict";a.r(t);var r=a(32),s=a(0),n=a.n(s),o=(a(1130),a(515)),l=a(493),i=a(546),c=a.n(i),d=(a(76),a(98)),p=a(14),_=a(9),u=a(3);t.default=function(){var e=Object(s.useState)([]),t=Object(r.a)(e,2),i=(t[0],t[1]),g=Object(s.useState)([]),j=Object(r.a)(g,2),f=j[0],h=j[1],v=Object(s.useState)([]),k=Object(r.a)(v,2),b=k[0],m=k[1],y=Object(s.useState)([]),w=Object(r.a)(y,2),O=(w[0],w[1]),x=Object(s.useState)([]),S=Object(r.a)(x,2),T=S[0],A=S[1],D=Object(s.useState)([]),N=Object(r.a)(D,2),B=N[0],C=N[1],W=Object(p.g)(),P=Object(s.useState)([]),E=Object(r.a)(P,2),z=E[0],F=E[1],J=Object(s.useState)([]),K=Object(r.a)(J,2),L=K[0],M=K[1],R=Object(s.useState)([]),U=Object(r.a)(R,2),q=U[0],G=U[1],H=Object(d.c)((function(e){var t=[];return Array.from(e.projects.pm_projects).forEach((function(e,a){t.push(e)})),t})),I=Object(s.useState)(H),Q=Object(r.a)(I,2),V=(Q[0],Q[1]),X=function(e){var t=[];if(console.log("filter",e),e.find((function(e){return"all"==e.value})))t.push(b),console.log("temp all",t);else{for(var a=0;a<e.length;a++)for(var r=0;r<b.length;r++)e[a].value==b[r].data.project.task_delivery_order.id&&(console.log(e[a].value,"matched! ",b[r].data.project.task_delivery_order.id),t.push(b[r].data));console.log("filtered array",t)}!function(e){console.log("data passed",e);for(var t=[],a=0;a<e.length;a++){for(var r=[],s=[],n=e[a].allassignees,o=e[a].assignees,l=0;l<n.length;l++){var i=Y(n[l].assignee.first_name)+" "+Y(n[l].assignee.last_name);r.push(i)}for(var c=0;c<o.length;c++){var d=Y(o[c].assignee.first_name)+" "+Y(o[c].assignee.last_name);s.push(d)}0!=e[a].assignees.length&&t.push({TDO:e[a].project.task_delivery_order.title,"Sub Task":e[a].project.sub_task,"Task Title":e[a].project.task_title,"Planned Delivery Date":e[a].project.planned_delivery_date,Assignees:r,"Assignees with no WBS":s,id:e[a].project.id})}console.log("aa",t),A(t);for(var p=[],_=0;_<e.length;_++){var u=e[_].allassignees;p.push({data:e[_],name:e[_].project.sub_task,tdo:e[_].project.task_delivery_order.title,id:e[_].project.task_delivery_order.id,startDate:e[_].project.date_created,endDate:e[_].project.planned_delivery_date,allassignees:e[_].allassignees,everyone:[],total:Number(e[_].assignees.length),assignees:e[_].assignees,wbs:e[_].project.wbs_list.length,nowbspeople:[],taskTitle:e[_].project.task_title});for(var g=0;g<u.length;g++){var j=u[g].assignee.first_name+" "+u[g].assignee.last_name;p[_].everyone.push(j)}for(var f=e[_].assignees,h=0;h<f.length;h++){var v=f[h].assignee.first_name+" "+f[h].assignee.last_name+",";p[_].nowbspeople.push(v)}}console.log("info array from populate",p),V(p);for(var k=[],b=0;b<e.length;b++)e[b].allassignees,k.push({assignees:e[b].allassignees,date_created:e[b].project.date_created,date_updated:e[b].project.date_updated,description:e[b].project.description,estimated_person:e[b].project.estimated_person,id:e[b].project.id,planned_delivery_date:e[b].project.planned_delivery_date,planned_hours:e[b].project.planned_hours,planned_value:e[b].project.planned_value,pm:e[b].project.pm,remaining_hours:e[b].project.remaining_hours,start_date:e[b].project.start_date,status:e[b].project.status,sub_task:e[b].project.sub_task,task_delivery_order:e[b].project.task_delivery_order,task_title:e[b].project.task_title,work_package_index:e[b].project.work_package_index,work_package_number:e[b].project.work_package_number});O(k),console.log("wbsinfoarray",k)}(t)};function Y(e){return void 0!=e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():""}n.a.useEffect((function(){H.length>0&&0==L.length&&M(H)}),[H]);var Z=function(e){var t=new Date,r=a(74),s=r(e).diff(r(t),"days");return console.log("end date",e),console.log("days left ",s+1),!(s+1<=0)};return n.a.useEffect((function(){_.a.get("project/assignees-with-project/").then((function(e){var t=[];console.log("Rain api response",e.data.data);for(var a=0;a<e.data.data.length;a++)0!=e.data.data[a].allassignees.length&&Z(e.data.data[a].project.planned_delivery_date)&&t.push(e.data.data[a]);console.log("response",t),C(t);for(var r=[],s=0;s<e.data.data.length;s++)if(Z(e.data.data[s].project.planned_delivery_date)){for(var n=[],o=[],l=e.data.data[s].allassignees,d=e.data.data[s].assignees,p=0;p<l.length;p++){var _=Y(l[p].assignee.first_name)+" "+Y(l[p].assignee.last_name);n.push(_)}for(var u=0;u<d.length;u++){var g=Y(d[u].assignee.first_name)+" "+Y(d[u].assignee.last_name);o.push(g)}0!=e.data.data[s].allassignees.length&&r.push({TDO:e.data.data[s].project.task_delivery_order.title,"Sub Task":e.data.data[s].project.sub_task,"Task Title":e.data.data[s].project.task_title,"Assigned Date":e.data.data[s].project.date_updated,Assignees:n,"Assignees with no WBS":o,id:e.data.data[s].project.id})}for(var j=[],f=0;f<e.data.data.length;f++)if(0!=e.data.data[f].assignees.length){var v=e.data.data[f];j.push({assignees:v.assignees,date_created:v.project.date_created,date_updated:v.project.date_updated,description:v.project.description,estimated_person:v.project.estimated_person,id:v.project.id,planned_delivery_date:v.project.planned_delivery_date,planned_hours:v.project.planned_hours,planned_value:v.project.planned_value,pm:v.project.pm,remaining_hours:v.project.remaining_hours,start_date:v.project.start_date,status:v.project.status,sub_task:v.project.sub_task,task_delivery_order:v.project.task_delivery_order,task_title:v.project.task_title,work_package_index:v.project.work_package_index,work_package_number:v.project.work_package_number})}console.log("111",j),console.log("temp",t),console.log("tableData",r),A(r),i(t),function(e){for(var t=[],a=0;a<e.length;a++)t.push({data:e[a],label:e[a].project.task_delivery_order.title,value:e[a].project.task_delivery_order.id});t.unshift({label:"Select All",value:"all",data:{}}),console.log("list",c()(t,"value")),G(c()(t,"value")),h(c()(t,"value"));for(var r=[],s=0;s<e.length;s++){var n=e[s].allassignees;r.push({data:e[s],name:e[s].project.sub_task,tdo:e[s].project.task_delivery_order.title,id:e[s].project.task_delivery_order.id,startDate:e[s].project.date_created,endDate:e[s].project.planned_delivery_date,allassignees:e[s].allassignees,everyone:[],total:Number(e[s].assignees.length),assignees:e[s].assignees,wbs:e[s].project.wbs_list.length,nowbspeople:[],taskTitle:e[s].project.task_title});for(var o=0;o<n.length;o++){var l=n[o].assignee.first_name+" "+n[o].assignee.last_name;r[s].everyone.push(l)}for(var i=e[s].assignees,d=0;d<i.length;d++){var p=i[d].assignee.first_name+" "+i[d].assignee.last_name+",";r[s].nowbspeople.push(p)}}console.log("info array",r),m(r),V(r);for(var _=[],u=0;u<e.length;u++)e[u].allassignees,_.push({assignees:e[u].allassignees,date_created:e[u].project.date_created,date_updated:e[u].project.date_updated,description:e[u].project.description,estimated_person:e[u].project.estimated_person,id:e[u].project.id,planned_delivery_date:e[u].project.planned_delivery_date,planned_hours:e[u].project.planned_hours,planned_value:e[u].project.planned_value,pm:e[u].project.pm,remaining_hours:e[u].project.remaining_hours,start_date:e[u].project.start_date,status:e[u].project.status,sub_task:e[u].project.sub_task,task_delivery_order:e[u].project.task_delivery_order,task_title:e[u].project.task_title,work_package_index:e[u].project.work_package_index,work_package_number:e[u].project.work_package_number});O(_),console.log("wbsinfoarray",_)}(t)}))}),[]),Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)(l.K,{children:[Object(u.jsx)(l.k,{lg:"9",children:Object(u.jsxs)("h3",{className:"timecards-page-header mb-3",children:["Create WBS for Assigned Projects "," "]})}),Object(u.jsx)(l.k,{lg:"3",className:"mb-3 pl-4",children:Object(u.jsx)(o.a,{className:"custom-forminput-6",placeholder:"Filter by TDOs",searchable:!0,options:q,isMulti:!0,onChange:function(e,t){console.log("select ",e,"action ",t),"select-option"==t.action?e.find((function(e){return"all"==e.value}))?(X(f.filter((function(e){return"all"!=e.value}))),F(f.filter((function(e){return"all"!=e.value}))),console.log("value",e)):(F(e),console.log("value",e),X(e)):"clear"==t.action?(F([]),X(f.filter((function(e){return"all"!=e.value})))):"remove-value"==t.action&&(F(e),0==e.length?X(f.filter((function(e){return"all"!=e.value}))):X(e))},value:z})}),Object(u.jsx)(l.k,{className:"mt-5 mb-3",children:Object(u.jsx)(l.m,{items:T,primary:!0,hover:!0,sorter:!0,striped:!0,bordered:!0,size:"sm",itemsPerPage:15,pagination:!0,fields:[{key:"TDO",_style:{width:"10%"},_classes:"font-weight-bold"},"Sub Task","Task Title",{key:"Assigned Date",_style:{width:"15%"}},{key:"Assignees",_style:{width:"20%"}},{key:"Assignees with no WBS",_style:{width:"20%"}},{key:"Action",_style:{width:"5%"}}],scopedSlots:{Action:function(e){return Object(u.jsx)("td",{children:Object(u.jsx)(l.b,{children:Object(u.jsx)(l.f,{type:"button",className:"create-wbs-from-modal float-right",size:"sm",onClick:function(){!function(e){console.log("item",e);for(var t=[],a=0;a<B.length;a++)if(B[a].project.id==e.id){console.log("match",B[a]);var r=B[a];t.push({assignees:r.allassignees,date_created:r.project.date_created,date_updated:r.project.date_updated,description:r.project.description,estimated_person:r.project.estimated_person,id:r.project.id,planned_delivery_date:r.project.planned_delivery_date,planned_hours:r.project.planned_hours,planned_value:r.project.planned_value,pm:r.project.pm,remaining_hours:r.project.remaining_hours,start_date:r.project.start_date,status:r.project.status,sub_task:r.project.sub_task,task_delivery_order:r.project.task_delivery_order,task_title:r.project.task_title,work_package_index:r.project.work_package_index,work_package_number:r.project.work_package_number})}W.push({pathname:"/dashboard/WBS/create-wbs",state:{task:t[0]}})}(e)},children:"Create WBS"})})})}}})})]})})}},1130:function(e,t,a){},538:function(e,t,a){var r=a(167),s=a(547),n=a(552),o=a(168),l=a(553),i=a(163);e.exports=function(e,t,a){var c=-1,d=s,p=e.length,_=!0,u=[],g=u;if(a)_=!1,d=n;else if(p>=200){var j=t?null:l(e);if(j)return i(j);_=!1,d=o,g=new r}else g=t?[]:u;e:for(;++c<p;){var f=e[c],h=t?t(f):f;if(f=a||0!==f?f:0,_&&h===h){for(var v=g.length;v--;)if(g[v]===h)continue e;t&&g.push(h),u.push(f)}else d(g,h,a)||(g!==u&&g.push(h),u.push(f))}return u}},546:function(e,t,a){var r=a(166),s=a(538);e.exports=function(e,t){return e&&e.length?s(e,r(t,2)):[]}},547:function(e,t,a){var r=a(548);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},548:function(e,t,a){var r=a(549),s=a(550),n=a(551);e.exports=function(e,t,a){return t===t?n(e,t,a):r(e,s,a)}},549:function(e,t){e.exports=function(e,t,a,r){for(var s=e.length,n=a+(r?1:-1);r?n--:++n<s;)if(t(e[n],n,e))return n;return-1}},550:function(e,t){e.exports=function(e){return e!==e}},551:function(e,t){e.exports=function(e,t,a){for(var r=a-1,s=e.length;++r<s;)if(e[r]===t)return r;return-1}},552:function(e,t){e.exports=function(e,t,a){for(var r=-1,s=null==e?0:e.length;++r<s;)if(a(t,e[r]))return!0;return!1}},553:function(e,t,a){var r=a(169),s=a(554),n=a(163),o=r&&1/n(new r([,-0]))[1]==1/0?function(e){return new r(e)}:s;e.exports=o},554:function(e,t){e.exports=function(){}}}]);
//# sourceMappingURL=29.976b9832.chunk.js.map